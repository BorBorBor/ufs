{% extends "accounting/base.html" %}
{% load i18n %}

{% block title %}{{ group.name }}{% endblock %}

{% block content %}

<h2>{% blocktrans with group.name as group_name %}Group summary for &ldquo;{{ group_name }}&rdquo;{% endblocktrans %}</h2>

<div id="groupinfo">
<h3>{% trans "Group info" %}</h3>
<table class="tabledetails">
    <tr>
        <th>{% trans "Warning limit" %}</th>
        {% if group.warn_limit %}
        <td>{{ group.warn_limit|stringformat:"0.2f" }}</td>
        {% else %}
        <td>{{ group.warn_limit }}</td>
        {% endif %}
    </tr>
    <tr>
        <th>{% trans "Blocking limit" %}</th>
        {% if group.block_limit %}
        <td>{{ group.block_limit|stringformat:"0.2f" }}</td>
        {% else %}
        <td>{{ group.block_limit }}</td>
        {% endif %}
    </tr>
</table>
</div>

<div id="transaction_actions">
<h3>{% trans "Transactions" %}</h3>
   <ul>
      <li><a href="{% url approve-transactions group.slug %}">{% trans "Approve transaction" %}{% if group.not_payed_transaction_set.count %}*{% endif %}</a></li>
      <li><a href="{% url register-transactions group.slug %}">{% trans "Register transaction" %}</a></li>
   </ul>
</div>

<div id="statements">
<h3>{% trans "Statements" %}</h3>
   <ul>
      <li><a href="{% url balance group.slug %}">{% trans "Balance statement" %}</a></li>
      <li><a href="{% url income group.slug %}">{% trans "Income statement" %}</a></li>
   </ul>
</div>

<div id="lists">
<h3>{% trans "Lists" %}</h3>
{% if not group.list_set.count %}
<p>{% trans "No lists configured for this group." %}</p>
{% else %}
<ul>
    {% for list in group.list_set.all %}
    <li>
      <a href="{% url view-list group.slug,list.slug %}">{{ list.name }}</a>,
      <a href="{% url edit-list group.slug,list.slug %}">{% trans "Edit"%}</a>,
      <a href="{% url delete-list group.slug,list.slug %}">{% trans "Delete"%}</a>
    </li>
    {% endfor %}
    <li>[<a href="{% url new-list group.slug %}">{% trans "New"%}</a>]</li>
</ul>
{% endif %}
</div>

{% if is_admin %}

<div id="accounts">
{% if not group.account_set.count %}
<h3>{% trans "Accounts" %}</h3>
<p>{% trans "No accounts found." %}</p>
{% else %}

<div class="coltwo">
<h3>{% trans "User accounts" %}</h3>
<table class="tablelist">
    <tr>
        <th>{% trans "Account" %}</th>
        <th>{% trans "Type" %}</th>
        <th>{% trans "Balance" %}</th>
    </tr>
{% for account in group.user_account_set %}
    <tr class="{% cycle evenrow,oddrow %}">
        <td><a href="{% url account-summary account.group.slug,account.slug %}">{{ account.name }}</a></td>
        <td>{{ account.get_type_display }}</td>
        <td class="align_right{% if account.is_blocked %} blocked{% endif %}">{{ account.balance|stringformat:"0.2f" }}</td>
    </tr>
{% endfor %}
</table>
</div>
<div class="coltwo">
<h3>{% trans "Group accounts" %}</h3>
<table class="tablelist">
    <tr>
        <th>{% trans "Account" %}</th>
        <th>{% trans "Type" %}</th>
        <th>{% trans "Balance" %}</th>
    </tr>
{% for account in group.group_account_set %}
    <tr class="{% cycle evenrow,oddrow %}">
        <td><a href="{% url account-summary account.group.slug,account.slug %}">{{ account.name }}</a></td>
        <td>{{ account.get_type_display }}</td>
        <td class="align_right{% if account.is_blocked %} blocked{% endif %}">{{ account.balance|stringformat:"0.2f" }}</td>
    </tr>
{% endfor %}
</table>
</div>

<p class="comment">{% trans "Please note, a negative balance in a liabilty account tells that the owner has money to spend, while a positive balance means it is time for a deposit." %}</p>

{% endif %}
</div>

<div id="transactions">
{% include "accounting/transaction_list.html" %}
</div>

{% endif %}

{% endblock %}
